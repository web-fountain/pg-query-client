.tree {
  display         : flex;
  flex-direction  : column;
  min-height      : 0;      /* allow child scroll areas to size */
  overflow        : hidden; /* keep window from scrolling; delegate to .scroller */
}

.list {
  user-select : none; /* AIDEV-NOTE: preserve selection for tree a11y via roving tabindex */
  position    : relative; /* AIDEV-NOTE: safe anchor; headless-tree may apply transforms/positioning */
}

.content {
  /* AIDEV-NOTE: Accordion-style body; default to collapsed and animate max-height + opacity + translate. */
  overflow: hidden;
  max-height: 0;
  opacity: 0;
  transform: translateY(-4px);
  transition:
    max-height var(--duration-250) var(--ease-standard),
    opacity var(--duration-200) var(--ease-standard),
    transform var(--duration-200) var(--ease-standard);
}
.tree[data-open="false"] .content {
  max-height: 0;
  opacity: 0;
  transform: translateY(-4px);
  pointer-events: none; /* AIDEV-NOTE: keep mounted but non-interactive when collapsed */
}
.tree[data-open="true"] .content {
  max-height: 40rem; /* AIDEV-NOTE: generous cap for typical lists; behaves like "auto" for animation. */
  opacity: 1;
  transform: translateY(0);
  pointer-events: auto;
}

@media (prefers-reduced-motion: reduce) {
  .content {
    transition: none;
  }
}

.header {
  display         : flex;
  align-items     : center;
  justify-content : space-between;
  gap             : var(--space-2);
  min-height      : var(--space-7);
  padding-inline  : var(--px-4);
  color           : var(--text-primary);
  cursor          : pointer;
  position        : relative; /* AIDEV-NOTE: positioning context for absolutely-placed header-tools */
}
.header-left {
  display        : inline-flex;
  align-items    : center;
  gap            : var(--space-2);
  cursor         : pointer;
  flex           : 1;
  min-width      : 0; /* AIDEV-NOTE: allow label to shrink and ellide before overlapping tools */
}
.header-toggle {
  display         : inline-flex;
  align-items     : center;
  justify-content : center;
  width           : 20px;
  height          : 20px;
  padding         : 0;
  border          : 0;
  background      : transparent;
  color           : var(--icon-fill);
  cursor          : pointer;
}
.header-label {
  flex           : 1;
  min-width      : 0; /* AIDEV-NOTE: allow shrinking for ellipsis */
  font-size      : var(--text-xs);
  font-weight    : 600;
  letter-spacing : 0.02em;
  overflow       : hidden;
  text-overflow  : ellipsis;
  white-space    : nowrap;
}

.scroller {
  position            : relative;
  overflow            : auto;
  flex                : 1;
  min-height          : 0;
  height              : 100%;
  margin-inline-end   : -1px; /* scrollbar is right against the browser edge */
  overscroll-behavior : contain; /* keep scroll interactions local to panel */
  padding-block-end   : var(--space-4);
  scrollbar-color     : transparent transparent; /* base hidden visuals */
}

/* AIDEV-NOTE: Apply gutter only when a scrollbar is present. */
.scroller[data-has-scrollbar="true"] {
  scrollbar-gutter    : stable;
}

/* AIDEV-NOTE: Collapsed state — show only the root row; do not force a 100% height scroller. */


/* AIDEV-NOTE: Toolbar in header (right-aligned, absolutely positioned to not occupy space when hidden) */
.header-tools {
  position       : absolute;
  right          : var(--px-4); /* AIDEV-NOTE: align with header padding-inline */
  top            : 50%;
  transform      : translateY(-50%);
  display        : inline-flex;
  align-items    : center;
  opacity        : 0;
  pointer-events : none;
  transition     : opacity var(--duration-150) var(--ease-standard);
  cursor         : default; /* AIDEV-NOTE: toolbar itself shouldn't indicate header-level toggle */
  z-index        : 1; /* lift above header-left for interaction when visible */
}

/* AIDEV-NOTE: Reveal tools when the expanded section is hovered. */
.tree[data-open="true"]:hover .header-tools {
  opacity: 1;
  pointer-events: auto;
}

/* AIDEV-NOTE: When tools are visible, add margin to the label so it truncates with ellipsis.
   This reserves space for the tools (≈60px) without affecting the parent container layout. */
.tree[data-open="true"]:hover .header-label {
  margin-right: 60px;
}

/* AIDEV-NOTE: Hover/focus fade-in for scrollbar visuals without changing thickness */
.scroller::-webkit-scrollbar-thumb,
.scroller::-webkit-scrollbar-track {
  background-color: transparent;
  transition: background-color var(--duration-150) var(--ease-standard);
}

.scroller:hover::-webkit-scrollbar-thumb {
  background-color: color-mix(in oklch, var(--foreground) 25%, transparent);
}

.scroller:hover::-webkit-scrollbar-track {
  background-color: transparent;
}

/* Firefox reveal */
.scroller:hover {
  scrollbar-color: color-mix(in oklch, var(--foreground) 25%, transparent) transparent;
}
